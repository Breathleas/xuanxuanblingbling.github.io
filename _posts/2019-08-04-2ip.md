---
title: mac与win配置内外网同时访问
date: 2019-08-04 00:00:00
categories:
- CTF/tools
tags: 
---


## 情景

假如现在有如下情况：

- 笔记本的无线网卡连接着热点，用于访问外网，网段为192.168.8.0/24，网关为192.168.8.1
- 笔记本的以太网卡连接着网线，用于访问内网，网段为10.10.10.0/24，网关为10.10.10.1
- 并且需要通过内网方位192.168.1.0/24，10.10.12.0/24这个两个网段

## 方法

所以路由配置的步骤是：

- 首先删除默认的路由
- 然后配置外网网关为默认路由
- 配置10.10.0.0/16的路由到内网网关（合并10.10.10.0/24和10.10.12.0/24两个网段为10.10.0.0/16，反正也是内网）
- 配置192.168.1.0/24的路由到内网网关

## 步骤

### mac

```bash
netstat -rn                                                         # 查看路由表
route get 0.0.0.0                                                   # 获取默认路由
sudo route delete 0.0.0.0                                           # 删除默认路由
sudo route add -net 0.0.0.0 192.168.8.1                             # 添加公网网关
route -n add -net 10.10.0.0 -netmask 255.255.0.0 10.10.10.1         # 添加 10.10.0.0/16 网段的路由
route -n add -net 192.168.1.0 -netmask 255.255.255.0 10.10.10.1     # 添加 192.168.1.0/24 网段的路由
```

### win

```bash
route print                                                         # 查看路由表
route delete 0.0.0.0                                                # 删除默认路由
route add 0.0.0.0 mask 0.0.0.0 192.168.8.1                          # 添加公网网关
route add 10.10.0.0  mask 255.255.0.0 10.10.10.1                    # 添加 10.10.0.0/16 网段的路由
route add 192.168.1.0 mask 255.255.255.0 10.10.10.1                 # 添加 192.168.1.0/24 网段的路由
```